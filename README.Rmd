---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# asgs.geocode

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
[![CRAN status](https://www.r-pkg.org/badges/version/asgs.geocode)](https://CRAN.R-project.org/package=asgs.geocode)
[![R-CMD-check](https://github.com/baslat/asgs.geocode/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/baslat/asgs.geocode/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

The goal of asgs.geocode is to be able to take an address and get the ASGS code for it.

## Installation

You can install the development version of asgs.geocode from [GitHub](https://github.com/) with:

``` r
# install.packages("pak")
pak::pak("baslat/asgs.geocode")
```

## Basic Example: Address to ASGS

The primary use case of {asgs.geocode} is to go from an address to an ASGS code. This is done with the `geocode()` and `get_asgs()` functions.

The simplest example is finding the ASGS code for an address or landmark. Let's get the 2021 SA2 of Melbourne Town Hall.

```{r example}
library(asgs.geocode)
## More specific addresses generally perform better
address <- "Melbourne Town Hall, Melbourne"
point <- geocode(address)
point

# It's returned three candidate matches, so let's plot them.
library(mapview)
mapview(point)

# They are all in the same place, so let's just take the one with the best (i.e. lowest) rank.
melb_town_hall <- dplyr::slice_min(point, rank)
melb_town_hall


# Now we can get the ASGS code for this point.
melb_th_sa2 <- get_asgs(melb_town_hall, "sa2", 2021)
melb_th_sa2

# And plot the SA2 and the points
mapview(melb_th_sa2) + mapview(melb_town_hall, col.regions = "red")
```

Other years and geographies (and some limited descriptions) are available with `get_layers()`:

```{r get_layers}
# See available year-geography layers
layers <- get_layers()
layers
```

## Intermediate Example: Points or Polygons to ASGS

We can also also more complex questions, like finding the ASGS code for points or polygon. Let's find the 2016 SA1s of IGA supermarkets in Canberra.

```{r cbr-iga}
# Set max results to 50 to get all the IGAs
iga <- geocode("IGA, ACT", 100)
iga

iga_sa1 <- get_asgs(iga, "sa1", 2016)
iga_sa1

mapview(iga_sa1) + mapview(iga, col.regions = "red")


```

Which SA3s are in an LGA?

What are the SA1s of the Coles in Canberra?
